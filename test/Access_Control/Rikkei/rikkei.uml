@startuml

interface IUnitroller {
    ' -- inheritance --

    ' -- usingFor --

    ' -- vars --

    ' -- methods --
	+ðŸ’°enterMarkets()
	+exitMarket()
	+ðŸ”borrowCaps()

}


interface ChainLinkOracle {
    ' -- inheritance --

    ' -- usingFor --

    ' -- vars --

    ' -- methods --
	+ðŸ”decimals()
	+ðŸ”latestRoundData()

}


interface ISimpleOraclePrice {
    ' -- inheritance --

    ' -- usingFor --

    ' -- vars --

    ' -- methods --
	+setOracleData()

}


class Exploit_Rikkei {
    ' -- inheritance --
	{abstract}TestHarness
	{abstract}TokenBalanceTracker

    ' -- usingFor --

    ' -- vars --
	#[[IRToken]] rBNB
	#[[IRToken]] rTokens
	#[[IWETH9]] wbnb
	#[[IERC20]] tokens
	#[[address]] attackerContract
	#[[IPancakeRouter01]] router
	#[[IUnitroller]] unitroller
	#[[ISimpleOraclePrice]] priceOracle

    ' -- methods --
	+setUp()
	+ðŸ’°**__constructor__**()
	+test_attack()
	#deployMaliciousOracle()

}


class MaliciousOracle {
    ' -- inheritance --
	{abstract}ChainLinkOracle

    ' -- usingFor --

    ' -- vars --
	#[[ChainLinkOracle]] bnbUSDOracle

    ' -- methods --
	+ðŸ”decimals()
	+ðŸ”latestRoundData()

}
' -- inheritance / usingFor --
Exploit_Rikkei --[#DarkGoldenRod]|> TestHarness
Exploit_Rikkei --[#DarkGoldenRod]|> TokenBalanceTracker
MaliciousOracle --[#DarkGoldenRod]|> ChainLinkOracle

@enduml